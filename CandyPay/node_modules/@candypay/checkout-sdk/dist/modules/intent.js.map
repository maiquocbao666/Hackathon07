{"version":3,"sources":["../../src/modules/intent.ts","../../src/generated-config.ts"],"sourcesContent":["import axios from \"axios\";\n\nimport {\n  Config,\n  CreateIntentOptions,\n  CreateIntentResponse,\n  IntentMetadataOptions,\n  IntentMetadataResponse,\n} from \"@/interfaces\";\nimport { CANDYPAY_API_URL } from \"../generated-config\";\n\nexport class PaymentIntent {\n  private network: string;\n  private options: Config;\n\n  constructor(network: string, options: Config) {\n    this.network = network;\n    this.options = options;\n  }\n\n  /**\n   * Create a new payment intent\n   *\n   * @returns\n   * Returns payment intent object along with `order_id`, `intent_id` and `intent_secret_key`\n   * @example\n   * ```ts\n   * const hipBagItem = {\n   *   name: \"Throwback Hip Bag\",\n   *   price: 4,\n   *   image: \"https://imgur.com/EntGcVQ.png\",\n   *   quantity: 5\n   * }\n   *\n   * const session = await candypay.paymentIntent.create({\n   *   tokens: [\"samo\", \"shdw\"],\n   *   items: [hipBagItem],\n   * })\n   * ```\n   */\n  async create(options: CreateIntentOptions): Promise<CreateIntentResponse> {\n    try {\n      const parameters = {\n        ...options,\n        network: this.network,\n        config: this.options.config,\n        is_intent: true,\n      };\n      let response = await axios.post(\n        `${CANDYPAY_API_URL}/intent`,\n        parameters,\n        {\n          headers: {\n            Authorization: `Bearer ${this.options.api_keys.private_api_key}`,\n          },\n        }\n      );\n\n      return response.data;\n    } catch (err) {\n      throw new Error(JSON.stringify(err.response.data, null, 2));\n    }\n  }\n\n  /**\n   * Fetch metadata of a payment intent\n   * @example\n   * ```ts\n   * const intentID = \"cp_pay_34059991-d572-46db-bd1c-225e467ee414\"\n   *\n   * const metadata = await candypay.paymentIntent.metadata({\n   *   intent_id: intentID\n   * })\n   * ```\n   */\n  async metadata(\n    options: IntentMetadataOptions\n  ): Promise<IntentMetadataResponse> {\n    try {\n      let response = await axios.get(`${CANDYPAY_API_URL}/intent`, {\n        params: {\n          intent_id: options.intent_id,\n        },\n        headers: {\n          Authorization: `Bearer ${this.options.api_keys.public_api_key}`,\n        },\n      });\n\n      return response.data;\n    } catch (err) {\n      throw new Error(JSON.stringify(err.response.data, null, 2));\n    }\n  }\n}\n","////////////////////////////////////////////////////////////////////////////////\n// This file is generated via a pre-build step via scripts/config.sh.\n////////////////////////////////////////////////////////////////////////////////\n\nexport const CANDYPAY_CONFIG_VERSION: \"development\" | \"production\" | string = \"production\";\nexport const CANDYPAY_API_URL = \"https://candypay-checkout-production.up.railway.app/api/v1\"\n\n"],"mappings":"u+BAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,mBAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAAkB,oBCKX,IAAMC,EAAmB,6DDMzB,IAAMC,EAAN,KAAMA,CAIXC,YAAYC,EAAiBC,EAAiB,CAHtCD,EAAAA,gBACAC,EAAAA,gBAGN,KAAKD,QAAUA,EACf,KAAKC,QAAUA,CACjB,CAsBA,MAAMC,OAAOD,EAA6D,CACxE,GAAI,CACF,IAAME,EAAaC,EAAAC,EAAA,GACdJ,GADc,CAEjBD,QAAS,KAAKA,QACdM,OAAQ,KAAKL,QAAQK,OACrBC,UAAW,EACb,GAWA,OAVe,MAAMC,EAAAA,QAAMC,KACzB,GAAGC,WACHP,EACA,CACEQ,QAAS,CACPC,cAAe,UAAU,KAAKX,QAAQY,SAASC,iBACjD,CACF,CAAA,GAGcC,IAClB,OAASC,EAAP,CACA,MAAM,IAAIC,MAAMC,KAAKC,UAAUH,EAAII,SAASL,KAAM,KAAM,CAAA,CAAA,CAC1D,CACF,CAaA,MAAMM,SACJpB,EACiC,CACjC,GAAI,CAUF,OATe,MAAMO,EAAAA,QAAMc,IAAI,GAAGZ,WAA2B,CAC3Da,OAAQ,CACNC,UAAWvB,EAAQuB,SACrB,EACAb,QAAS,CACPC,cAAe,UAAU,KAAKX,QAAQY,SAASY,gBACjD,CACF,CAAA,GAEgBV,IAClB,OAASC,EAAP,CACA,MAAM,IAAIC,MAAMC,KAAKC,UAAUH,EAAII,SAASL,KAAM,KAAM,CAAA,CAAA,CAC1D,CACF,CACF,EAlFajB,EAAAA,EAAAA","names":["intent_exports","__export","PaymentIntent","__toCommonJS","import_axios","CANDYPAY_API_URL","PaymentIntent","constructor","network","options","create","parameters","__spreadProps","__spreadValues","config","is_intent","axios","post","CANDYPAY_API_URL","headers","Authorization","api_keys","private_api_key","data","err","Error","JSON","stringify","response","metadata","get","params","intent_id","public_api_key"]}